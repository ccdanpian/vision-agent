# 模式选择使用指南

## 概述

交互式模式启动时，用户可以选择使用**快速模式**或**智能模式**，两种模式各有优势。

---

## 启动流程

### 步骤 1：启动交互式模式

```bash
python run.py -i
```

### 步骤 2：选择模式

```
==================================================
           选择任务分类模式
==================================================

请选择任务输入模式：
  1. 快速模式（固定格式，零成本，极速响应）
  2. 智能模式（自然语言，AI理解）

请输入选项（1 或 2）:
```

---

## 模式 1：快速模式

### 特点

- ✅ **零成本**：不调用 LLM，完全免费
- ✅ **极速响应**：<10ms，几乎无延迟
- ✅ **100% 准确**：固定格式，不会误解
- ✅ **适合高频任务**：重复性操作

### 输入格式

系统会自动在输入前添加 `ss:` 前缀，您只需输入：

#### 发消息格式

```
消息:联系人:消息内容
```

**示例**：
```
消息:张三:你好
消息:李四:早上好，今天开会
消息:王五:下午见
```

#### 发朋友圈格式

```
朋友圈:朋友圈内容
```

**示例**：
```
朋友圈:今天天气真好
朋友圈:分享一张美图
```

### 完整交互示例

```bash
$ python run.py -i

（连接设备...）

==================================================
           选择任务分类模式
==================================================

请选择任务输入模式：
  1. 快速模式（固定格式，零成本，极速响应）
  2. 智能模式（自然语言，AI理解）

请输入选项（1 或 2）: 1

==================================================
           快速模式（SS格式）
==================================================

格式说明：
  发消息：消息:联系人:消息内容
  发朋友圈：朋友圈:朋友圈内容

示例：
  消息:张三:你好
  消息:李四:早上好，今天开会
  朋友圈:今天天气真好

提示：
  - 冒号支持中英文（: 或 ：）
  - 输入 'q' 或 'quit' 退出
  - 按 Ctrl+C 也可以退出

--------------------------------------------------
请输入任务（快速格式）: 消息:张三:你好

开始执行任务: ss:消息:张三:你好
[TaskClassifier] 检测到 SS 快速模式
...（执行成功）

--------------------------------------------------
请输入任务（快速格式）: 朋友圈:今天天气真好

开始执行任务: ss:朋友圈:今天天气真好
...（执行成功）

--------------------------------------------------
请输入任务（快速格式）: q
退出交互式模式
```

### 注意事项

1. **冒号支持中英文**
   ```
   消息:张三:你好      ✓ 正确
   消息：张三：你好    ✓ 正确（中文冒号）
   消息:张三：你好     ✓ 正确（混用）
   ```

2. **自动添加 ss: 前缀**
   - 输入：`消息:张三:你好`
   - 实际执行：`ss:消息:张三:你好`

3. **不要手动输入 ss:**
   - ❌ 错误：`ss:消息:张三:你好`（重复了）
   - ✓ 正确：`消息:张三:你好`

---

## 模式 2：智能模式

### 特点

- ✅ **自然语言**：按照说话方式输入
- ✅ **AI 理解**：自动识别意图和参数
- ✅ **容错性强**：多种表达方式都能识别
- ✅ **适合复杂任务**：多步骤、组合任务

### 输入格式

**自由文本**，用自然语言描述任务即可。

**示例**：
```
给张三发消息说你好
给李四发消息说早上好，今天开会
发朋友圈今天天气真好
给王五发消息然后截图
```

### 完整交互示例

```bash
$ python run.py -i

（连接设备...）

==================================================
           选择任务分类模式
==================================================

请选择任务输入模式：
  1. 快速模式（固定格式，零成本，极速响应）
  2. 智能模式（自然语言，AI理解）

请输入选项（1 或 2）: 2

==================================================
           智能模式（自然语言）
==================================================

说明：
  直接用自然语言描述任务，AI 会自动理解

示例：
  给张三发消息说你好
  给李四发消息说早上好，今天开会
  发朋友圈今天天气真好

提示：
  - 无效输入会自动提示重新输入
  - 输入 'q' 或 'quit' 退出
  - 按 Ctrl+C 也可以退出

--------------------------------------------------
请输入任务（自然语言）: 给张三发消息说你好

开始执行任务: 给张三发消息说你好
[TaskClassifier] 检测到非 SS 模式
[TaskClassifier] LLM解析: send_msg
...（执行成功）

--------------------------------------------------
请输入任务（自然语言）: 发朋友圈今天天气真好

开始执行任务: 发朋友圈今天天气真好
...（执行成功）

--------------------------------------------------
请输入任务（自然语言）: aaa

开始执行任务: aaa
[TaskClassifier] LLM判断：无效输入

错误: 无效的输入指令。请输入有效的任务描述

--------------------------------------------------
请重新输入任务（自然语言，输入 'q' 取消）: 给李四发消息说下午见

开始执行任务: 给李四发消息说下午见
...（执行成功）
```

### 无效输入处理

智能模式会自动识别无效输入（如：`aaa`、`!!!`、空白等），并提示重新输入：

```
请输入任务（自然语言）: aaa

（识别为 invalid）

错误: 无效的输入指令。请输入有效的任务描述

--------------------------------------------------
请重新输入任务（自然语言，输入 'q' 取消）:
```

---

## 两种模式对比

| 特性 | 快速模式 | 智能模式 |
|------|---------|---------|
| **输入方式** | 固定格式（消息:人:内容） | 自然语言 |
| **响应速度** | ⚡⚡⚡ <10ms | 🐌 ~500ms |
| **成本** | 💰 零成本 | 💰💰 有成本 |
| **准确率** | ✅ 100% | ✅ 95% |
| **学习曲线** | 需要记格式 | 无需学习 |
| **适用场景** | 高频任务、批量操作 | 探索使用、复杂任务 |
| **容错性** | ❌ 格式错误会失败 | ✅ 多种表达方式 |
| **Invalid 检测** | ❌ 无（格式错误直接失败） | ✅ 自动识别并重试 |

---

## 使用建议

### 场景 1：日常高频任务

**推荐：快速模式**

```
1（选择快速模式）

消息:张三:你好
消息:李四:早上好
消息:王五:下午见
朋友圈:今天天气真好
```

**优势**：
- 零成本
- 极速响应
- 批量操作方便

### 场景 2：首次使用 / 探索功能

**推荐：智能模式**

```
2（选择智能模式）

给张三发消息说你好
发朋友圈今天天气真好
```

**优势**：
- 自然语言，无需记格式
- 容错性强
- 适合学习

### 场景 3：复杂任务

**推荐：智能模式**

```
2（选择智能模式）

给张三发消息说你好然后截图
打开微信并搜索李四
```

**优势**：
- 支持多步骤任务
- AI 自动理解意图

### 场景 4：脚本自动化

**推荐：单任务模式 + SS 格式**

```bash
# 不使用交互式模式
python run.py -t "ss:消息:张三:你好"
python run.py -t "ss:朋友圈:今天天气真好"
```

**优势**：
- 适合脚本调用
- 零成本
- 可预测

---

## 常见问题

### Q1: 可以在运行中切换模式吗？

**A**: 不可以。模式在启动时选择，运行期间不能切换。如果想换模式，需要退出（输入 `q`）后重新启动。

### Q2: 快速模式下输入错误格式会怎样？

**A**: 系统会识别为无效的 SS 格式，可能导致解析失败。建议严格按照格式输入：
- ✓ `消息:张三:你好`
- ✗ `发消息给张三说你好`（这是智能模式的语法）

### Q3: 智能模式的无效输入是什么？

**A**: 以下输入会被识别为 invalid：
- 空白输入：`""`、`"   "`
- 无意义字符：`aaa`、`123`、`!!!`
- 误触：`s`、`、、、`
- 不清楚的指令：`帮我`、`嗯`

### Q4: 快速模式支持中文冒号吗？

**A**: 完全支持。以下都是有效的：
- `消息:张三:你好`
- `消息：张三：你好`
- `消息:张三：你好`

### Q5: 快速模式下需要输入 ss: 前缀吗？

**A**: 不需要！系统会自动添加。
- 你输入：`消息:张三:你好`
- 实际执行：`ss:消息:张三:你好`

### Q6: 单任务模式（python run.py -t）会提示选择模式吗？

**A**: 不会。单任务模式根据输入自动判断：
- 以 `ss:` 开头 → 快速模式
- 其他 → 智能模式

---

## 技术实现

### 模式选择逻辑

```python
# 启动时提示选择
mode_choice = input("请输入选项（1 或 2）: ")

if mode_choice == '1':
    # 快速模式
    task_input = input("请输入任务（快速格式）: ")
    task = f"ss:{task_input}"  # 自动添加前缀
else:
    # 智能模式
    task_input = input("请输入任务（自然语言）: ")
    task = task_input  # 直接使用
```

### 自动添加 ss: 前缀

```python
if mode_choice == '1':
    if not task_input.lower().startswith('ss:'):
        task = f"ss:{task_input}"
    else:
        task = task_input
```

### 重试时保持模式

```python
# 重试时根据模式提示不同的输入方式
if mode_choice == '1':
    new_task_input = input("请重新输入任务（快速格式）: ")
    task = f"ss:{new_task_input}"
else:
    new_task_input = input("请重新输入任务（自然语言）: ")
    task = new_task_input
```

---

## 总结

### 快速模式（模式 1）

**适合**：
- 高频任务
- 批量操作
- 成本敏感
- 追求极速

**格式**：
- `消息:联系人:内容`
- `朋友圈:内容`

### 智能模式（模式 2）

**适合**：
- 首次使用
- 复杂任务
- 自然交互
- 探索功能

**格式**：
- 自然语言，任意表达

### 推荐组合

| 用户类型 | 推荐模式 |
|---------|---------|
| **新用户** | 智能模式（学习阶段） |
| **熟练用户** | 快速模式（日常使用） |
| **脚本开发者** | 单任务 + SS 格式 |
| **预算有限** | 快速模式（零成本） |
| **追求便捷** | 智能模式（无需记格式） |

启动交互式模式，选择适合您的模式，开始高效的任务执行！
